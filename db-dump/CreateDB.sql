-- SQL PARA CREAR LA BD
DROP DATABASE IF EXISTS ProyectoP1BDA;
CREATE DATABASE ProyectoP1BDA;
USE ProyectoP1BDA;

DROP TABLE IF EXISTS Survey;
CREATE TABLE Survey(
	id INT PRIMARY KEY AUTO_INCREMENT NOT NULL,
    name VARCHAR(55) NOT NULL,
    description TEXT NOT NULL
);

DROP TABLE IF EXISTS Question;
CREATE TABLE Question(
	id INT PRIMARY KEY AUTO_INCREMENT NOT NULL,
    id_Survey INT NOT NULL,
    question VARCHAR(55) NOT NULL,
    type VARCHAR(20) NOT NULL,
    
    FOREIGN KEY (id_Survey) REFERENCES Survey(id) ON DELETE CASCADE ON UPDATE CASCADE
);

DROP TABLE IF EXISTS Multiple_Option;
CREATE TABLE Multiple_Option(
	id INT PRIMARY KEY AUTO_INCREMENT NOT NULL,
    id_Question INT NOT NULL,
    answer VARCHAR(55) NOT NULL,
    
    FOREIGN KEY (id_Question) REFERENCES Question(id) ON DELETE CASCADE ON UPDATE CASCADE 
);

DROP TABLE IF EXISTS User;
CREATE TABLE User(
	id INT PRIMARY KEY AUTO_INCREMENT NOT NULL,
    name VARCHAR(55) NOT NULL,
    password VARCHAR(55) NOT NULL
);


DROP TABLE IF EXISTS User_Multiple_Options;
CREATE TABLE User_Multiple_Options(
	id INT PRIMARY KEY AUTO_INCREMENT NOT NULL,
    id_User INT NOT NULL,
    id_Multiple_Options INT NOT NULL,
    
	FOREIGN KEY (id_User) REFERENCES User(id) ON DELETE CASCADE ON UPDATE CASCADE,
    FOREIGN KEY (id_Multiple_Options) REFERENCES Multiple_Option(id) ON DELETE CASCADE ON UPDATE CASCADE
);



DROP TABLE IF EXISTS User_Survey;
CREATE TABLE User_Survey(
	id INT PRIMARY KEY AUTO_INCREMENT NOT NULL,
    id_User INT NOT NULL,
    id_Survey INT NOT NULL,
    
    FOREIGN KEY (id_User) REFERENCES User(id) ON DELETE CASCADE ON UPDATE CASCADE,
    FOREIGN KEY (id_Survey) REFERENCES Survey(id) ON DELETE CASCADE ON UPDATE CASCADE
);

DROP TABLE IF EXISTS UseQuestion_UserAnswer;
CREATE TABLE UseQuestionr_UserAnswer(
	id INT PRIMARY KEY AUTO_INCREMENT NOT NULL,
    id_Question INT NOT NULL,
    id_User INT NOT NULL,
    
    
    FOREIGN KEY (id_User) REFERENCES User(id) ON DELETE CASCADE ON UPDATE CASCADE,
    FOREIGN KEY (id_Question) REFERENCES Question(id) ON DELETE CASCADE ON UPDATE CASCADE
);

DROP TABLE IF EXISTS User_Answer;
CREATE TABLE User_Answer(
	id INT PRIMARY KEY AUTO_INCREMENT NOT NULL,
    id_UseQuestionr_UserAnswer INT NOT NULL,
    answer VARCHAR(255) NOT NULL,
    
    FOREIGN KEY (id_UseQuestionr_UserAnswer) REFERENCES UseQuestionr_UserAnswer(id) ON DELETE CASCADE ON UPDATE CASCADE
);